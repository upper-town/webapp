<%= turbo_frame_tag "admin_user_codes" do %>
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="card-title mb-0"><%= t("admin.admin_users.show.codes") %></h5>
    </div>
    <div class="card-body">
      <div class="admin-pagination-search-row mb-3">
        <div class="admin-pagination-search-row__pagination">
          <%= render(PaginationComponent.new(@pagination, align: :start)) %>
        </div>
        <%= render(Admin::SearchFormComponent.new(
          url: codes_admin_admin_user_path(@admin_user),
          search_term: @search_term,
          placeholder: t("admin.admin_codes.index.search_placeholder")
        )) %>
      </div>

      <%=
        render(Admin::TableComponent.new(
          collection: @admin_codes,
          empty_message: t("admin.admin_codes.index.empty_message"),
          columns: [
            [t("admin.shared.id"), -> { link_to(it.id, admin_admin_code_path(it), class: "fw-medium", data: { turbo_frame: "_top" }) }, { copyable: :id }],
            [t("admin.codes.columns.purpose"), -> { content_tag(:code, it.purpose, class: "small") }, { copyable: :purpose }],
            [t("admin.admin_sessions.columns.expires"), -> { l(it.expires_at) }, { copyable: ->(it) { l(it.expires_at) } }],
            [t("admin.admin_sessions.columns.status"), -> {
              if it.expired?
                content_tag(:span, t("admin.shared.expired"), class: "badge bg-secondary")
              else
                content_tag(:span, t("admin.shared.active"), class: "badge bg-success")
              end
            }],
            [t("admin.shared.created"), -> { l(it.created_at) }, { copyable: ->(it) { l(it.created_at) } }],
            [t("admin.shared.actions"), -> {
              render(Admin::IndexActionsComponent.new(
                view_path: admin_admin_code_path(it),
                link_options: { data: { turbo_frame: "_top" } }
              ))
            }],
          ],
        ))
      %>

      <%= render(PaginationComponent.new(@pagination, align: :start)) %>
    </div>
  </div>
<% end %>
