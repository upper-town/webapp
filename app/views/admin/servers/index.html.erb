<h1 class="mb-4"><%= t("admin.servers.index.title") %></h1>

<div class="admin-pagination-search-row mb-3">
  <div class="admin-pagination-search-row__pagination">
    <%= render(PaginationComponent.new(@pagination, align: :start)) %>
  </div>
  <%= render(Admin::SearchFormComponent.new(
    url: admin_servers_path,
    search_term: @search_term,
    placeholder: t("admin.servers.index.search_placeholder")
  )) %>
</div>

<%=
  render(Admin::TableComponent.new(
    collection: @servers,
    empty_message: t("admin.servers.index.empty_message"),
    columns: [
        [t("admin.shared.id"), -> { link_to(it.id, admin_server_path(it), class: "fw-medium") }, { copyable: :id }],
        [t("admin.servers.columns.name"), -> { it.name.presence || content_tag(:span, t("admin.shared.empty_placeholder"), class: "text-body-secondary") }, { copyable: :name }],
        [t("admin.servers.columns.game"), -> { it.game&.name || content_tag(:span, t("admin.shared.empty_placeholder"), class: "text-body-secondary") }, { copyable: ->(it) { it.game&.name } }],
        [t("admin.servers.columns.site_url"), -> { link_to(truncate(it.site_url, length: 35), it.site_url, target: "_blank", rel: "noopener", class: "text-break") }, { copyable: :site_url }],
        [t("admin.servers.columns.country"), -> { it.country&.iso_short_name || it.country_code || content_tag(:span, t("admin.shared.empty_placeholder"), class: "text-body-secondary") }, { copyable: ->(it) { it.country&.iso_short_name || it.country_code } }],
        [t("admin.admin_sessions.columns.status"), -> { render(Admin::ServerStatusBadgesComponent.new(server: it)) }],
        [t("admin.shared.actions"), -> {
          render(Admin::IndexActionsComponent.new(
            view_path: admin_server_path(it),
            edit_path: edit_admin_server_path(it),
            extra_actions: [{ path: server_path(it), label: t("admin.servers.edit_actions.public"), target: "_blank", rel: "noopener" }]
          ))
        }],
    ],
  ))
%>

<%= render(PaginationComponent.new(@pagination, align: :start)) %>
