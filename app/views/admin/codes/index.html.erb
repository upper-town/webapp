<h1 class="mb-4"><%= t("admin.codes.index.title") %></h1>

<div class="admin-pagination-search-row mb-3">
  <div class="admin-pagination-search-row__pagination">
    <%= render(PaginationComponent.new(@pagination, align: :start)) %>
  </div>
  <%= render(Admin::SearchFormComponent.new(
    url: admin_codes_path,
    search_term: @search_term,
    placeholder: t("admin.codes.index.search_placeholder")
  )) %>
</div>

<%=
  render(Admin::TableComponent.new(
    collection: @codes,
    empty_message: t("admin.codes.index.empty_message"),
    columns: [
      [t("admin.shared.id"), -> { link_to(it.id, admin_code_path(it), class: "fw-medium") }, { copyable: :id }],
      [
        t("admin.codes.columns.user"),
        -> { link_to(it.user.email, admin_user_path(it.user)) },
        { copyable: ->(it) { it.user&.email } },
      ],
      [t("admin.codes.columns.purpose"), -> { content_tag(:code, it.purpose, class: "small") }, { copyable: :purpose }],
      [t("admin.admin_sessions.columns.expires"), -> { l(it.expires_at) }, { copyable: ->(it) { l(it.expires_at) } }],
      [
        t("admin.admin_sessions.columns.status"),
        -> {
          if it.expired?
            content_tag(:span, t("admin.shared.expired"), class: "badge text-bg-secondary")
          else
            content_tag(:span, t("admin.shared.active"), class: "badge text-bg-success")
          end
        },
      ],
      [t("admin.shared.created"), -> { l(it.created_at) }, { copyable: ->(it) { l(it.created_at) } }],
      [t("admin.shared.actions"), -> { render(Admin::IndexActionsComponent.new(view_path: admin_code_path(it))) }],
    ],
  ))
%>

<%= render(PaginationComponent.new(@pagination, align: :start)) %>
