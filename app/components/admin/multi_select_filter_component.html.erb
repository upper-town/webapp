<div
  class="admin-multi-select-filter"
  data-controller="admin-multi-select-filter"
  data-admin-multi-select-filter-param-name-value="<%= param_name %>"
  data-admin-multi-select-filter-options-value="<%= options_json %>"
  data-admin-multi-select-filter-selected-value="<%= selected_ids.to_json %>"
  data-all-label="<%= all_label %>"
  data-count-label="<%= count_label %>"
  data-admin-multi-select-filter-count-label-one-value="<%= count_label_one %>"
>
  <div class="dropdown" data-admin-multi-select-filter-target="dropdown">
    <button
      type="button"
      class="<%= select_class %> dropdown-toggle d-flex align-items-center justify-content-between text-start"
      id="<%= dropdown_id %>"
      data-bs-toggle="dropdown"
      data-bs-auto-close="outside"
      aria-expanded="false"
      aria-haspopup="listbox"
      aria-label="<%= aria_label %>"
    >
      <span class="admin-multi-select-filter__trigger-text text-truncate" data-admin-multi-select-filter-target="triggerText">
        <%= trigger_text %>
      </span>
      <i class="bi bi-chevron-down admin-multi-select-filter__caret" aria-hidden="true"></i>
    </button>
    <div class="dropdown-menu p-2" role="listbox">
      <div class="mb-2 input-group input-group-sm">
        <input
          type="search"
          class="form-control"
          placeholder="<%= placeholder %>"
          autocomplete="off"
          data-admin-multi-select-filter-target="searchInput"
          data-action="input->admin-multi-select-filter#filter keydown->admin-multi-select-filter#handleKeydown keydown.enter->admin-multi-select-filter#submitForm focus->admin-multi-select-filter#onSearchFocus"
          aria-label="<%= placeholder %>"
        >
        <button
          type="button"
          class="btn btn-outline-primary"
          data-action="click->admin-multi-select-filter#submitForm"
          aria-label="<%= apply_label %>"
        >
          <%= apply_label %>
        </button>
      </div>
      <div id="<%= options_list_id %>" data-admin-multi-select-filter-target="optionsList" role="group">
        <% options.each do |name, id| %>
          <button
            type="button"
            class="dropdown-item d-flex align-items-center gap-2"
            role="option"
            data-id="<%= id %>"
            data-name="<%= name %>"
            data-admin-multi-select-filter-target="option"
            data-action="click->admin-multi-select-filter#toggle"
          >
            <span class="form-check">
              <input
                type="checkbox"
                class="form-check-input"
                <%= "checked" if option_checked?(id) %>
                tabindex="-1"
                aria-hidden="true"
              >
            </span>
            <span class="text-truncate"><%= name %></span>
          </button>
        <% end %>
      </div>
      <div class="admin-multi-select-filter__no-results visually-hidden" data-admin-multi-select-filter-target="noResults">
        <%= no_results_label %>
      </div>
    </div>
  </div>
  <div class="admin-multi-select-filter__hidden-inputs" data-admin-multi-select-filter-target="hiddenInputs">
    <% selected_ids.each do |id| %>
      <input type="hidden" name="<%= hidden_input_name %>" value="<%= id %>" data-admin-multi-select-filter-target="hiddenInput">
    <% end %>
  </div>
</div>
